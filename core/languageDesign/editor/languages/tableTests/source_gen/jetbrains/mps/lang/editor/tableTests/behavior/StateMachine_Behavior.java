package jetbrains.mps.lang.editor.tableTests.behavior;

/*Generated by MPS */

import jetbrains.mps.smodel.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;

public class StateMachine_Behavior {
  public static void init(SNode thisNode) {
    int count = 3;
    for (int i = 0; i < count; i++) {
      SNode event = SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.Event", null);
      SPropertyOperations.set(event, "name", "e_" + i);
      ListSequence.fromList(SLinkOperations.getTargets(thisNode, "events", true)).addElement(event);
    }
    for (int i = 0; i < count; i++) {
      SNode state = SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.State", null);
      SPropertyOperations.set(state, "name", "s_" + i);
      ListSequence.fromList(SLinkOperations.getTargets(thisNode, "states", true)).addElement(state);
    }
    for (int i = 0; i < count; i++) {
      SNode sourceState = ListSequence.fromList(SLinkOperations.getTargets(thisNode, "states", true)).getElement(i);
      SNode targetState = ListSequence.fromList(SLinkOperations.getTargets(thisNode, "states", true)).getElement((i + 1 == count ?
        0 :
        i + 1
      ));
      SNode event = ListSequence.fromList(SLinkOperations.getTargets(thisNode, "events", true)).getElement(i);

      SNode transition = SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.Transition", null);
      SLinkOperations.setTarget(transition, "fromState", SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.StateReference", null), true);
      SLinkOperations.setTarget(SLinkOperations.getTarget(transition, "fromState", true), "state", sourceState, false);
      SLinkOperations.setTarget(transition, "toState", SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.StateReference", null), true);
      SLinkOperations.setTarget(SLinkOperations.getTarget(transition, "toState", true), "state", targetState, false);
      SLinkOperations.setTarget(transition, "trigger", SConceptOperations.createNewNode("jetbrains.mps.lang.editor.tableTests.structure.EventReference", null), true);
      SLinkOperations.setTarget(SLinkOperations.getTarget(transition, "trigger", true), "event", event, false);
      SPropertyOperations.set(transition, "condition", "true");
      ListSequence.fromList(SLinkOperations.getTargets(thisNode, "transitions", true)).addElement(transition);
    }
  }
}
